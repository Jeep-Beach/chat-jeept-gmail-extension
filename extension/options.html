<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatJeePeeTee Settings</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="jeepbeach-options">
        <h1>ChatJeePeeTee Settings</h1>
        
        <div class="section">
            <h2>API Configuration</h2>
            <div class="form-group">
                <label for="apiKey">OpenAI API Key</label>
                <input type="password" id="apiKey" placeholder="sk-...">
                <div class="help-text">Your OpenAI API key. Get one at <a href="https://platform.openai.com/api-keys" target="_blank">platform.openai.com</a></div>
            </div>
            
            <div class="form-group">
                <label for="provider">LLM Provider</label>
                <select id="provider">
                    <option value="openai">OpenAI (GPT-4o-mini)</option>
                    <option value="anthropic">Anthropic (Claude-3-haiku)</option>
                </select>
            </div>
        </div>
        
        <div class="section">
            <h2>Response Settings</h2>
            <div class="form-group">
                <label for="tone">Response Tone</label>
                <textarea id="tone" placeholder="friendly, concise, cheerful + helpful"></textarea>
                <div class="help-text">Describe the tone you want for generated replies</div>
            </div>
            
            <div class="form-group">
                <label for="fallbackMessage">Fallback Message</label>
                <textarea id="fallbackMessage" placeholder="Thanks for reaching out! The fastest path is our FAQs: https://jeepbeach.com/faq/&#10;If you still need help, just reply here and we'll jump in."></textarea>
                <div class="help-text">Message to use when no relevant information is found</div>
            </div>
        </div>
        
        <div class="section">
            <h2>JeepBeach Content Sources</h2>
            <div class="form-group">
                <label for="jeepBeachUrls">Jeep Beach URLs to Monitor</label>
                <textarea id="jeepBeachUrls" class="url-list" placeholder="https://jeepbeach.com/&#10;https://jeepbeach.com/faq/&#10;https://jeepbeach.com/events/&#10;https://jeepbeach.com/registration/"></textarea>
                <div class="help-text">One URL per line. Content will be cached for 4 hours.</div>
            </div>
        </div>
        
        <div class="section">
            <h2>Gmail Integration</h2>
            <div class="form-group">
                <div class="checkbox-group">
                    <input type="checkbox" id="useGmailApi">
                    <label for="useGmailApi">Use Gmail API for context (requires OAuth setup)</label>
                </div>
                <div class="help-text">When enabled, fetches the latest inbound message via Gmail API instead of reading from DOM. More reliable but requires additional setup.</div>
            </div>
        </div>
        
        <div class="button-group">
            <button id="saveSettings">Save Settings</button>
            <button id="testLLM" class="secondary">Test LLM</button>
            <button id="refreshCache" class="secondary">Refresh Site Cache</button>
            <button id="resetDefaults" class="secondary">Reset to Defaults</button>
        </div>
        
        <div id="status" class="status" style="display: none;"></div>
        
        <div class="section">
            <h2>Setup Instructions</h2>
            <div class="help-text">
                <h3>Basic Setup:</h3>
                <ol>
                    <li>Get an OpenAI API key from <a href="https://platform.openai.com/api-keys" target="_blank">platform.openai.com</a></li>
                    <li>Paste the API key above and click "Save Settings"</li>
                    <li>Go to Gmail and start composing a reply</li>
                    <li>Click the "ChatJeePeeTee" button that appears</li>
                </ol>
                
                <h3>Optional Gmail API Setup:</h3>
                <ol>
                    <li>Go to <a href="https://console.developers.google.com/" target="_blank">Google Cloud Console</a></li>
                    <li>Create a new project or select existing one</li>
                    <li>Enable the Gmail API</li>
                    <li>Create OAuth 2.0 credentials (Web application)</li>
                    <li>Add your extension ID to authorized origins</li>
                    <li>Update the client_id in manifest.json</li>
                    <li>Enable "Use Gmail API for context" above</li>
                </ol>
                
                <h3>Known Limitations:</h3>
                <ul>
                    <li>Button only appears when composing/replying in Gmail</li>
                    <li>Site content is cached for 4 hours</li>
                    <li>Drafts are generated based on visible email content</li>
                    <li>Requires internet connection for LLM calls</li>
                </ul>
            </div>
        </div>
    </div>
    
    <script src="utils/storage.js"></script>
    <script src="utils/llm.js"></script>
    <script src="options.js"></script>
</body>
</html>